<!DOCTYPE html>
<html lang="en">

<!-- Head tag -->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">

  <!--Description-->
  

  <!--Author-->
  
  <meta name="author" content="Daniel Scheufler">
  

  <!--Open Graph Title-->
  
      <meta property="og:title" content="Pretty Good Encryption"/>
  
  <!--Open Graph Description-->
  
  <!--Open Graph Site Name-->
  <meta property="og:site_name" content="A Journeyman&#39;s Travels"/>
  <!--Type page-->
  
      <meta property="og:type" content="article" />
  
  <!--Page Cover-->
  

  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <!-- Title -->
  
  <title>Pretty Good Encryption - A Journeyman&#39;s Travels</title>


  <link rel="shortcut icon" href="/img/logo/star_catcher_mountainsx96.png">

  <!-- Custom CSS/Sass -->
  <link rel="stylesheet" href="/css/style.css">

  <!----------------------------
  https://github.com/GallenHu/hexo-theme-Daily

 _____            _   _
|  __ \          (_) | |
| |  | |   __ _   _  | |  _   _
| |  | |  / _` | | | | | | | | |
| |__| | | (_| | | | | | | |_| |
|_____/   \__,_| |_| |_|  \__, |
                          __/ |
                         |___/

    --------------------------->

</head>


<body>

  <!-- Nav -->
  <header class="site-header">
  <div class="header-inside">
    <div class="logo">
      <a href="/" rel="home">
        
        <img src="/img/logo/star_catcher_mountains.png" alt="A Journeyman's Travels" height="60">
        
      </a>
    </div>
    <!-- Navigation -->
    <nav class="navbar">
      <!-- Collect the nav links, forms, and other content for toggling -->
      <div class="collapse">
        <ul class="navbar-nav">
          
          
            <li>
              <a href="/.">
                
                  Home
                
              </a>
            </li>
          
            <li>
              <a href="/featured">
                
                  Featured
                
              </a>
            </li>
          
            <li>
              <a href="/about">
                
                  About
                
              </a>
            </li>
          
            <li>
              <a href="/archives">
                
                  Archive
                
              </a>
            </li>
          
        </ul>
      </div>
      <!-- /.navbar-collapse -->
    </nav>
    <div class="button-wrap">
      <button class="menu-toggle">Primary Menu</button>
    </div>
  </div>
</header>


  <!-- Main Content -->
  <div class="content-area">
  <div class="post">
    <!-- Post Content -->
    <div class="container">
      <article>
        <!-- Title date & tags -->
        <div class="post-header">
          <h1 class="entry-title">
            Pretty Good Encryption
            
          </h1>
          <p class="posted-on">
          2016-09-13
          </p>
          <div class="tags-links">
            
              
                <a href="/tags/python/" rel="tag">
                  python
                </a>
              
                <a href="/tags/software/" rel="tag">
                  software
                </a>
              
                <a href="/tags/software dev/" rel="tag">
                  software dev
                </a>
              
                <a href="/tags/tool/" rel="tag">
                  tool
                </a>
              
                <a href="/tags/tools/" rel="tag">
                  tools
                </a>
              
                <a href="/tags/recent work/" rel="tag">
                  recent work
                </a>
              
                <a href="/tags/algorithms/" rel="tag">
                  algorithms
                </a>
              
                <a href="/tags/encryption/" rel="tag">
                  encryption
                </a>
              
                <a href="/tags/infrastructure/" rel="tag">
                  infrastructure
                </a>
              
                <a href="/tags/interprocess comminitation/" rel="tag">
                  interprocess comminitation
                </a>
              
                <a href="/tags/protection/" rel="tag">
                  protection
                </a>
              
                <a href="/tags/security/" rel="tag">
                  security
                </a>
              
            
          </div>
        </div>
        <!-- Post Main Content -->
        <div class="entry-content has_line_number">
          <p><img src="/img/post_img/crypto_lock.png" alt="Bits and Bytes Lock">
<em>(Edit: 2018/10/21 - It has come to my attention that this encryption scheme does not conform to PGP proper. As such, please consider this 'Pretty Good Encryption' rather than PGP. This post has been updated to accomodate the new terminology.)</em></p>
<p>Shortly after starting with my new company, I began work on a back-end infrastructure project. To be specific, I am working on an inter-process-communication (hereafter IPC) layer. As the project developed, we realized the need to protect our data in transit. This is because we are working with Protect Health Information (hereafter PHI). It would be a disaster if the data became compromised. So to combat this, we are encrypting the data before it is send through the IPC layer. There are many fine encryption schemes available, but many are difficult to implement. Moreover, it is not enough to just encrypt the data. One cannot continue to use the same key for all applications without risk. Enough messages using the same key, and enough time mean someone could learn it. They would then be free to read all our messages and the possible PHI contained within. Our brilliant architect suggested that we use <a href="https://en.wikipedia.org/wiki/Pretty_Good_Privacy" target="_blank" rel="noopener">Pretty Good Encryption</a> or PGE for short.</p>
<p>It is an easy to implement encryption scheme that combines many desirable features. PGP uses a new random key for each message to encrypt the outbound data. This key is itself encrypted by a known private key, and is sent along with the encrypted message. Since the key is random every time, it is difficult to guess the private key. As a result, one cannot decrypt the public key, thus the message is reasonably safe. To help explain this, I have crafted a simple example in python code, using a <a href="https://en.wikipedia.org/wiki/Vigen%C3%A8re_cipher" target="_blank" rel="noopener">Vigenere Cipher</a>. You can find the entire example project on my GitHub Repo, <a href="https://github.com/djscheuf/ProgamingPractice/blob/Playground/Playground/Cryptography/PGP/example.py" target="_blank" rel="noopener">here</a>. But the core of the example is as follows:
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encodePGE</span><span class="params">(self,plainMsg)</span>:</span> </span><br><span class="line"><span class="comment"># generate random key </span></span><br><span class="line"></span><br><span class="line">randKey = self._generateRandomKey() </span><br><span class="line">print(<span class="string">"&gt; Internal Random Key: "</span>+randKey) </span><br><span class="line"></span><br><span class="line"><span class="comment"># encrypt input with ^ </span></span><br><span class="line">cryptographer = Crypto() </span><br><span class="line">encryptedMsg = cryptographer.encode(randKey,plainMsg) </span><br><span class="line"></span><br><span class="line"><span class="comment"># encrypt random key with priv. </span></span><br><span class="line">key pubKey = cryptographer.encode(self.privateKey,randKey) </span><br><span class="line"></span><br><span class="line"><span class="comment">#return concat encrypted key and input </span></span><br><span class="line"><span class="keyword">return</span> pubKey + <span class="string">"_"</span>+encryptedMsg</span><br></pre></td></tr></table></figure></p>
<p>For those who prefer, a visual representation of this is available on the Wikipedia page for PGP. The algorithm is as I stated before:</p>
<ol>
<li>Generate a Random Key for the message</li>
<li>Encrypt the message with the Random key</li>
<li>Encrypt the Random Key with the Private Key, to form the public key</li>
<li>Concatenate the Encrypted Message and Public Key</li>
</ol>
<p>The code for Decoding is as follows:
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decodePGE</span><span class="params">(self,concatMsg)</span>:</span> </span><br><span class="line"><span class="comment">#parse encrypted pub key, encrypted message </span></span><br><span class="line">parsed = concatMsg.split(<span class="string">"_"</span>) </span><br><span class="line">pubKey = parsed[<span class="number">0</span>] </span><br><span class="line">encryptedMsg = parsed[<span class="number">1</span>] </span><br><span class="line"></span><br><span class="line"><span class="comment"># decrypt rand key with priv. key </span></span><br><span class="line">cryptographer = Crypto() </span><br><span class="line">randKey = cryptographer.decode(self.privateKey, pubKey)</span><br><span class="line"> </span><br><span class="line"><span class="comment"># decrypt message with rand key </span></span><br><span class="line">decryptedMsg = cryptographer.decode(randKey,encryptedMsg) </span><br><span class="line"></span><br><span class="line"><span class="comment">#return message </span></span><br><span class="line"><span class="keyword">return</span> decryptedMsg</span><br></pre></td></tr></table></figure></p>
<p>In plain terms the decryption steps are:</p>
<ol>
<li>Parse the input message to get the Public Key and the Encrypted Message</li>
<li>Decrypt the Public key with the Private key, to form the original Random Key</li>
<li>Use the Random Key to Decrypt the Encrypted Message</li>
</ol>
<p>Ridiculously simple right?! However, this method can be rendered vulnerable by using a weak encryption method, such as the Vigenere Cipher, as I have. Though,it should be clear that a PGP-Vigenere is stronger that Vigenere alone. As you can see, with a strong encryption method, PGP adds a significant increase in security. The cost is that it increases the complexity in a limited fashion. Naturally, I will be adding this to my tool kit for future projects! I hope this explanation and example has been helpful. But I admit the diagram on Wikipedia provides a good outline of the PGE scheme. For anyone interested, you can download the example and the Vigenere Cipher implementation <a href="https://github.com/djscheuf/ProgamingPractice/tree/Playground/Playground/Cryptography/PGP" target="_blank" rel="noopener">here</a>.</p>

        </div>
      </article>
    </div>
    <!-- Comments -->
    <div class="container">
      
<section id="comment">
  <!-- <h1 class="title">Comments</h1> -->

  
</section>


    </div>
    <!-- Pre or Next -->
    <div class="nav-links">
      
        <div class="nav-previous">
          <a href="/2016/10/11/mit-is-asking-how-should-self-driving-cars-behave/" rel="prev"><span class="meta-arraw meta-arraw-left"></span> Older Posts</a>
        </div>
      
      
        <div class="nav-next">
          <a href="/2016/06/23/defensive-programming-revisited/" rel="prev">Newer Posts <span class="meta-arraw meta-arraw-right"></span></a>
        </div>
      
    </div>

  </div>
</div>


  <!-- Footer -->
  <!-- Footer-widgets -->
<div class="footer-widgets">
  <div class="row inside-wrapper">
    <div class="col-1-3">
      <aside>
        <h1 class="widget-title">A Journeyman&#39;s Travels</h1>
        <div class="custom-widget-content">
          
          <span>Blog by <a href="/about">Daniel Scheufler</a>. <a href="/rss2.xml">RSS Feed</a></span>
        </div>
      </aside>
    </div>
    <div class="col-1-3">
      <aside>
        <h1 class="widget-title">Contact</h1>
        <div class="widget-text">
          
            
              <a href="https://github.com/djscheuf" class="icon icon-github" target="_blank">github</a>
            
              <a href="mailto:daniel@scheufler.io" class="icon icon-mail" target="_blank">mail</a>
            
              <a href="https://www.linkedin.com/in/danielscheufler/" class="icon icon-linkedin" target="_blank">linkedin</a>
            
          
        </div>
      </aside>
    </div>
    <div class="col-1-3">
      <aside>
        <h2 class="widget-title">Created with <a href="https://hexo.io">Hexo</a></h2>
        <div class="widget-text">
        <span>Theme based on <a href="https://github.com/GallenHu/hexo-theme-Daily">Daily</a></span>
        </div>
      </aside>
    </div>
  </div>
</div>
<!-- Footer -->
<footer class="site-info">
  <p>
    <span>A Journeyman's Travels &copy; 2018</span>
  </p>
</footer>


  <!-- After footer scripts -->
  <!-- scripts -->

<!-- google_analytics start -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-86343000-1', 'auto');
  ga('send', 'pageview');

</script>
<!-- google_analytics end -->



</body>

</html>
